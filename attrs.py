from datatypes import (
    SimpleField,
    EncodedString,
    FieldWithOptions,
    Coordenadas,
    GerarPlai,
)
from constants import MUNICIPIOS, SERVICOS

ALL = {"status": "", "description": "", "start_date": "", "due_date": ""}

SPECIAL = [
    "latitude_coordenadas",
    "longitude_coordenadas",
    "latitude_da_estacao",
    "longitude_da_estacao",
    "gerar_plai",
]

HIDDEN = ["gerar_plai", "gerar_relatorio", "Html"]

TIPOS_DE_INSPECAO = {
    "Técnica": [
        "agrupamento",
        "coordenacao_responsavel",
        "entidade_da_inspecao",
        "fiscais",
        "fiscal_responsavel",
        "horas_de_conclusao",
        "horas_de_deslocamento",
        "horas_de_execucao",
        "horas_de_preparacao",
        "no_pcdp",
        "no_sav",
        "no_sei_processo_fiscalizacao",
        "precisa_reservar_instrumentos",
        "procedimentos",
        "servicos_da_inspecao",
        "tipo_de_inspecao",
        "ufmunicipio",
        "utilizou_algum_instrumento",
    ]
}


FIELDS = {
    "acao_de_risco_a_vida_criada": SimpleField(154, "Ação de risco à vida criada?"),
    "agrupamento": SimpleField(213, "Agrupamento"),
    "altura_do_sistema_irradiante": SimpleField(131, "Altura do sistema irradiante"),
    "area_do_pacp": FieldWithOptions(
        416,
        "Área do PACP",
        options=[
            "1-Comércio",
            "2-ISP",
            "3-E-commerce",
            "4-Aduana",
            "5-Feiras e Eventos",
            "6-Supervisão de Mercados",
        ],
        format_value=True,
    ),
    "campo_eletrico__pico_vm": SimpleField(195, "Campo elétrico - pico (V/m)", True),
    "campo_eletrico_rms_vm": SimpleField(194, "Campo elétrico RMS (V/m)", True),
    "cnpjcpf_da_entidade": SimpleField(141, "CNPJ/CPF da Entidade"),
    "coordenacao_responsavel": SimpleField(178, "Coordenação responsável"),
    "coordenadas_estacao": Coordenadas(718, "Coordenadas Estação"),
    "coordenadas_geograficas": Coordenadas(717, "Coordenadas Geográficas"),
    "copiar_instrumento_da_reserva": FieldWithOptions(
        629, "Copiar instrumento da reserva?", options=["0", "1"]
    ),
    "dadospacp": SimpleField(415, "DadosPACP"),
    "documento_instaurador_do_pado": SimpleField(134, "Documento instaurador do PADO"),
    "endereco_da_inspecao": SimpleField(142, "Endereço da Inspeção", True),
    "entidade_com_cadastro_stel": FieldWithOptions(
        189, "Entidade com cadastro STEL?", True, options=["Sim", "Não"]
    ),
    "entidade_da_inspecao": SimpleField(30, "Entidade da Inspeção", True),
    "entidade_outorgada": FieldWithOptions(
        138,
        "Entidade outorgada?",
        True,
        options=["0", "1"],
        mapping={"1": ["numero_da_estacao"]},
    ),
    "esta_em_operacao": FieldWithOptions(
        139, "Está em operação?", True, options=["0", "1"]
    ),
    "fiscais": SimpleField(26, "Fiscais", True, True),
    "fiscal_responsavel": SimpleField(25, "Fiscal responsável", True),
    "foi_constatada_interferencia": FieldWithOptions(
        1967, "Foi constatada interferência?", True, options=["0", "1"]
    ),
    "frequencia_inicial": SimpleField(156, "Frequência inicial", True),
    "frequencia_final": SimpleField(158, "Frequência final", True),
    "frequencias": SimpleField(180, "Frequência(s)"),
    "gerar_plai": GerarPlai(426, "Gerar PLAI"),
    "gerar_relatorio": FieldWithOptions(
        541,
        "Gerar Relatório",
        options=["0", "1"],
        mapping={"1": ["Html"]},
    ),
    "horas_de_conclusao": SimpleField(94, "Horas de conclusão", True),
    "horas_de_deslocamento": SimpleField(92, "Horas de deslocamento", True),
    "horas_de_execucao": SimpleField(93, "Horas de Execução", True),
    "horas_de_preparacao": SimpleField(91, "Horas de Preparação", True),
    "houve_interferencia": FieldWithOptions(
        149,
        "Houve interferência?",
        True,
        options=["Sim", "Não"],
        mapping={"Sim": ["identificada_a_origem"]},
    ),
    "houve_obice": FieldWithOptions(136, "Houve óbice?", True, options=["0", "1"]),
    "identificada_a_origem": FieldWithOptions(
        162,
        "Identificada a origem?",
        True,
        options=["0", "1"],
        mapping={"1": ["sanada_ou_mitigada"]},
    ),
    "identificacao_da_nao_outorgada": SimpleField(
        250, "Identificação da não Outorgada"
    ),
    "instrumentos_utilizados": SimpleField(599, "Instrumentos Utilizados", True),
    "irregularidade": FieldWithOptions(
        73,
        "Irregularidade",
        multiple=True,
        options=[
            "Comercialização de produtos",
            "Utilização de produtos",
            "Conteúdo",
            "Outros aspectos não técnicos",
            "Recursos de acessibilidade",
            "Frequência diversa da autorizada",
            "Local da estação diverso do autorizado",
            "Outras irregularidades técnicas (especificar)",
            "Potência diversa da autorizada",
        ],
        format_value=True,
    ),
    "lai_vinculadas": SimpleField(481, "LAI vinculadas"),
    "latitude_coordenadas": SimpleField(170, "Latitude (coordenadas)", True),
    "latitude_da_estacao": SimpleField(191, "Latitude da estação", True),
    "longitude_coordenadas": SimpleField(171, "Longitude (coordenadas)", True),
    "longitude_da_estacao": SimpleField(192, "Longitude da estação", True),
    "motivo_de_lai": FieldWithOptions(
        164,
        "Motivo de LAI",
        mandatory=True,
        multiple=True,
        options=[
            "Risco à vida",
            "Clandestinidade",
            "Interferência prejudicial",
            "Uso de produto não certificado",
            " Garantir a segurança (exposição a campos eletromagnéticos)",
            " Necessidade de assegurar o planejamento, o gerenciamento e a coordenação do uso de espectro de radiofrequências (justificar)",
        ],
    ),
    "numero_da_estacao": SimpleField(137, "Número da estação", True),
    "no_de_homologacao": SimpleField(161, "Nº de homologação"),
    "no_do_lacre": SimpleField(165, "Nº do lacre", True),
    "no_pcdp": SimpleField(112, "Nº PCDP"),
    "no_sav": SimpleField(111, "Nº SAV"),
    "no_sei_do_aviso_lai": EncodedString(427, "Nº SEI do Aviso LAI", True),
    "no_sei_do_plaiguarda": EncodedString(426, "Nº SEI do PLAI/Guarda"),
    "no_sei_processo_fiscalizacao": EncodedString(422, "Nº SEI Processo Fiscalização"),
    "no_sei_relatorio_monitoramento": SimpleField(
        544, "Nº SEI Relatório Monitoramento"
    ),
    "nome_da_entidade": SimpleField(140, "Nome da Entidade", True),
    "observacao_tecnica_amostral": SimpleField(
        693, "Observação (técnica amostral)", True
    ),
    "observacoes": SimpleField(1973, "Observações"),
    "pai_instaurado_pela_anatel": SimpleField(160, "PAI instaurado pela Anatel?", True),
    "potencia_medida": SimpleField(81, "Potência medida"),
    "precisa_reservar_instrumentos": FieldWithOptions(
        596,
        "Precisa reservar instrumentos?",
        True,
        options=["0", "1"],
        mapping={"1": ["reserva_de_instrumentos"]},
    ),
    "procedimentos": FieldWithOptions(
        71,
        "Procedimentos",
        True,
        True,
        options=[
            "Nenhum",
            "Lacração",
            "Apreensão",
            "Interrupção",
            "Não Cadastrado",
            "Notificado",
            "A Notificar",
            "Liberação/Desinterrupção",
            "Orientação ao Usuário",
            "Comunicado",
            "Deslacrado",
            "Vistoriado",
            "Emissão Termo Violação de Lacre",
            "Apoio a busca e apreensão",
            "Investigação/Pesquisa",
            "Não Lacrado - Impedimento",
            "Não Lacrado - Amparo Judicial",
            "Não Lacrado - Responsável Ausente",
            "Não Lacrado - Local Fechado",
            "Constatação Violação Lacre/Relacrado",
            "Constatação Violação Lacre/Impedimento",
            "Notícia Crime",
            "Monitorado alterado",
            "Constatação Encerramento - Informe",
            "Levantamento de Dados",
            "Análise/coleta de Dados",
            "Monitorado",
            "Não Lacrado - Desativado",
            "Devolução de Produto(s)",
            "Outros",
        ],
        mapping={
            "Lacração": [
                "no_do_lacre",
                "motivo_de_lai",
                "no_sei_do_aviso_lai",
                "lai_vinculadas",
                "no_sei_do_plaiguarda",
                "gerar_plai",
            ],
            "Apreensão": [
                "motivo_de_lai",
                "no_sei_do_aviso_lai",
                "lai_vinculadas",
                "no_sei_do_plaiguarda",
                "gerar_plai",
            ],
            "Interrupção": [
                "motivo_de_lai",
                "no_sei_do_aviso_lai",
                "lai_vinculadas",
                "no_sei_do_plaiguarda",
                "gerar_plai",
            ],
        },
    ),
    "qnt_produt_lacradosapreend": SimpleField(
        143, "Qnt. produt. lacrados/apreend.", True
    ),
    "qtd_de_emissoes": SimpleField(69, "Qtd. de Emissões"),
    "qtd_identificadas": SimpleField(731, "Qtd. Identificadas"),
    "qtd_licenciadas": SimpleField(730, "Qtd. Licenciadas"),
    "reserva_de_instrumentos": SimpleField(
        597, "Reserva de instrumentos", True, True, True
    ),
    "sanada_ou_mitigada": FieldWithOptions(
        159, "Sanada ou mitigada?", True, options=["1", "0"]
    ),
    "servicos_da_inspecao": FieldWithOptions(
        57,
        "Serviços da Inspeção",
        True,
        multiple=True,
        options=SERVICOS,
        format_value=True,
    ),
    "situacao_constatada": FieldWithOptions(
        62,
        "Situação constatada",
        True,
        options=["Regular", "Irregular", "Inconclusivo", "Não analisado"],
    ),
    "situacao_de_risco_a_vida": FieldWithOptions(
        150,
        "Situação de risco à vida?",
        True,
        options=["Sim", "Não"],
        format_value=True,
    ),
    "tipificacao_da_infracao": SimpleField(148, "Tipificação da infração"),
    "tipo_de_inspecao": FieldWithOptions(
        2,
        "Tipo de inspeção",
        True,
        options=[
            "Bloqueio Administrativo",
            "Certificação",
            "Medição de CEMRF (RNI)",
            "Outorga - Aspectos não Técnicos",
            "Outorga - Aspectos Técnicos",
            "Uso do Espectro - Interferência",
            "Uso do Espectro - Monitoração",
            "Uso do Espectro - Não Outorgado",
        ],
        format_value=True,
        mapping={
            "Bloqueio Administrativo": [
                "nome_da_entidade",
                "observacao_tecnica_amostral",
                "utilizou_algum_instrumento",
                "utilizou_tecnicas_amostrais",
            ],
            "Certificação": [
                "endereco_da_inspecao",
                "entidade_com_cadastro_stel",
                "houve_obice",
                "latitude_coordenadas",
                "longitude_coordenadas",
                "observacao_tecnica_amostral",
                "qnt_produt_lacradosapreend",
                "situacao_constatada",
                "utilizou_tecnicas_amostrais",
                "area_do_pacp",
                "cnpjcpf_da_entidade",
                "documento_instaurador_do_pado",
                "irregularidade",
            ],
            "Medição de CEMRF (RNI)": [
                "campo_eletrico__pico_vm",
                "campo_eletrico_rms_vm",
                "entidade_outorgada",
                "frequencia_final",
                "frequencia_inicial",
                "latitude_coordenadas",
                "latitude_da_estacao",
                "longitude_coordenadas",
                "longitude_da_estacao",
                "nome_da_entidade",
                "observacao_tecnica_amostral",
                "tipo_de_medicao",
                "servicos_da_inspecao",
                "unidade_da_frequencia_final",
                "unidade_da_frequencia_inicial",
                "utilizou_tecnicas_amostrais",
                "cnpjcpf_da_entidade",
            ],
            "Outorga - Aspectos não Técnicos": [
                "irregularidade",
                "observacao_tecnica_amostral",
                "pai_instaurado_pela_anatel",
                "servicos_da_inspecao",
                "situacao_constatada",
                "utilizou_tecnicas_amostrais",
                "cnpjcpf_da_entidade",
            ],
            "Outorga - Aspectos Técnicos": [
                "cnpjcpf_da_entidade",
                "entidade_outorgada",
                "esta_em_operacao",
                "houve_interferencia",
                "houve_obice",
                "latitude_coordenadas",
                "longitude_coordenadas",
                "observacao_tecnica_amostral",
                "servicos_da_inspecao",
                "situacao_constatada",
                "situacao_de_risco_a_vida",
                "uso_de_produto_homologado",
                "utilizou_apoio_policial",
                "utilizou_tecnicas_amostrais",
                "altura_do_sistema_irradiante",
                "cnpjcpf_da_entidade",
                "documento_instaurador_do_pado",
                "frequencias",
                "irregularidade",
                "potencia_medida",
                "unidade_de_frequencia",
                "unidade_de_potencia",
            ],
            "Uso do Espectro - Interferência": [
                "foi_constatada_interferencia",
                "observacao_tecnica_amostral",
                "utilizou_tecnicas_amostrais",
                "observacoes",
            ],
            "Uso do Espectro - Monitoração": [
                "qtd_de_emissoes",
                "qtd_licenciadas",
                "qtd_identificadas",
                "latitude_coordenadas",
                "longitude_coordenadas",
                "acao_de_risco_a_vida_criada",
                "frequencia_inicial",
                "unidade_da_frequencia_inicial",
                "frequencia_final",
                "unidade_da_frequencia_final",
                "no_sei_relatorio_monitoramento",
                "coordenadas_geograficas",
            ],
            "Uso do Espectro - Não Outorgado": [
                "entidade_com_cadastro_stel",
                "uso_de_produto_homologado",
                "situacao_constatada",
                "irregularidade",
                "potencia_medida",
                "unidade_de_potencia",
                "frequencias",
                "unidade_de_frequencia",
                "utilizou_apoio_policial",
                "qnt_produt_lacradosapreend",
                "tipificacao_da_infracao",
                "houve_interferencia",
                "situacao_de_risco_a_vida",
                "latitude_coordenadas",
                "longitude_coordenadas",
                "identificacao_da_nao_outorgada",
                "utilizou_tecnicas_amostrais",
                "observacao_tecnica_amostral",
                "coordenadas_geograficas",
            ],
        },
    ),
    "tipo_de_medicao": SimpleField(193, "Tipo de medição"),
    "tipo_do_processo_plai": FieldWithOptions(
        426,
        "Tipo do Processo PLAI",
        options=[
            "Gestão da Fiscalização: Lacração, Apreensão e Interrupção",
            "Gestão da Fiscalização: Processo de Guarda",
        ],
    ),
    "total_de_horas": SimpleField(1789, "Total de horas"),
    "ufmunicipio": FieldWithOptions(
        31,
        "UF/Município",
        True,
        True,
        MUNICIPIOS,
        format_value=True,
    ),
    "unidade_da_frequencia_final": SimpleField(
        159,
        "Unidade da frequência final",
        True,
        options=["Hz", "kHz", "MHz", "GHz", "THz"],
    ),
    "unidade_da_frequencia_inicial": SimpleField(
        157,
        "Unidade da frequência inicial",
        True,
        options=["Hz", "kHz", "MHz", "GHz", "THz"],
    ),
    "unidade_de_frequencia": SimpleField(84, "Unidade de Frequência"),
    "unidade_de_potencia": SimpleField(82, "Unidade de Potência"),
    "uso_de_produto_homologado": FieldWithOptions(
        132,
        "Uso de produto homologado?",
        True,
        options=["0", "1"],
        mapping=["no_de_homologacao"],
    ),
    "utilizou_algum_instrumento": FieldWithOptions(
        598,
        "Utilizou algum instrumento?",
        True,
        options=["0", "1"],
        mapping={"1": ["instrumentos_utilizados", "copiar_instrumento_da_reserva"]},
    ),
    "utilizou_apoio_policial": FieldWithOptions(
        75,
        "Utilizou apoio policial?",
        True,
        options=["Nenhum", "Polícia Civil", "Polícia Militar", "Polícia Federal"],
    ),
    "utilizou_tecnicas_amostrais": FieldWithOptions(
        692,
        "Utilizou técnicas amostrais?",
        True,
        options=["Usou técnicas amostrais", "Não usou técnicas amostrais"],
    ),
}
